<!DOCTYPE html>
<!--suppress HtmlUnknownTarget,HtmlFormInputWithoutLabel -->
<html lang="en">
<head>
    <title>Furry Badges</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Badges for furry websites!">
    <!-- meta og -->
    <meta property="og:title" content="Furry Badges"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://furry-badges.herokuapp.com"/>
    <meta property="og:image" content="https://furry-badges.herokuapp.com/assets/logo.png"/>
    <meta property="og:image:alt" content="Stylized paw overlaid with a stylized badge with a tail"/>
    <meta property="og:description" content="Badges for furry websites!">
    <!-- meta twitter -->
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Furry Badges"/>
    <meta name="twitter:url" content="https://furry-badges.herokuapp.com"/>
    <meta name="twitter:image" content="https://furry-badges.herokuapp.com/assets/logo.png">
    <meta name="twitter:image:alt" content="Stylized paw overlaid with a stylized badge with a tail">
    <meta name="twitter:description" content="Badges for furry websites!">
    <!-- favicons -->
    <link href="/assets/favicon.ico" rel="shortcut icon">
    <link href="/assets/touch-icon.png" rel="icon">
    <link href="/assets/touch-icon.png" rel="apple-touch-icon">
    <link href="/assets/touch-icon.png" rel="apple-touch-icon-precomposed">
    <link href="//fonts.googleapis.com/css?family=Rubik:300,400,500,700" rel="stylesheet" type="text/css"/>
    <link href="//cdn.muicss.com/mui-0.10.3/css/mui.min.css" rel="stylesheet" type="text/css"/>
    <script src="//cdn.muicss.com/mui-0.10.3/js/mui.min.js"></script>
    <style>
        body {
            font-family: Rubik, -apple-system, sans-serif;
        }

        select:disabled, label:disabled {
            display: none;
        }

        #colorPickers * {
            cursor: pointer;
        }

        .footer {
            width: 100%;
            text-align: center;
        }

        @media only screen and (min-height: 700px) {
            .footer {
                position: fixed;
                left: 0;
                bottom: 0;
                height: 30px;
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
{% set animals_ = ["Wolf", "Fox", "Bear", "Dog", "Dragon", "Otter", "Tiger", "Cat"] %}
{% set placeholder_animal = animals_[range(0, animals | length) | random] %}
<div style="max-width: 600px; margin: auto">
    <div style="margin: 20px">
        <div id="badges">
            <a href="https://github.com/FurryCoders/furry-badges">
                <img src="https://img.shields.io/badge/Source-GitHub-blue?logo=github" alt=""></a>
            <a href="https://github.com/FurryCoders/Furry-Badges/issues/new?labels=enhancement&template=logo-request.yml&title=%5BLogo+Request%5D%3A+">
                <img src="https://img.shields.io/badge/Logo-Request-blue?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNOC40NTYgMTQuNDk0YS43NS43NSAwIDAxMS4wNjguMTcgMy4wOCAzLjA4IDAgMDAuNTcyLjQ5MkEzLjM4MSAzLjM4MSAwIDAwMTIgMTUuNzJjLjg1NSAwIDEuNDg3LS4yODMgMS45MDQtLjU2MmEzLjA4MSAzLjA4MSAwIDAwLjU3Mi0uNDkybC4wMjEtLjAyNmEuNzUuNzUgMCAwMTEuMTk3LjkwNWwtLjAyNy4wMzRjLS4wMTMuMDE2LS4wMy4wMzgtLjA1Mi4wNjMtLjA0NC4wNS0uMTA1LjExOS0uMTg0LjE5OGE0LjU2OSA0LjU2OSAwIDAxLS42OTUuNTY2QTQuODggNC44OCAwIDAxMTIgMTcuMjJhNC44OCA0Ljg4IDAgMDEtMi43MzYtLjgxNCA0LjU3IDQuNTcgMCAwMS0uNjk1LS41NjYgMy4yNTMgMy4yNTMgMCAwMS0uMjM2LS4yNjFjLS4yNTktLjMzMi0uMjIzLS44MjQuMTIzLTEuMDg0eiI+PC9wYXRoPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyIDFDNS45MjUgMSAxIDUuOTI1IDEgMTJzNC45MjUgMTEgMTEgMTEgMTEtNC45MjUgMTEtMTFTMTguMDc1IDEgMTIgMXpNMi41IDEyYTkuNSA5LjUgMCAxMTE5IDAgOS41IDkuNSAwIDAxLTE5IDB6Ij48L3BhdGg+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTkgMTAuNzVhMS4yNSAxLjI1IDAgMTEtMi41IDAgMS4yNSAxLjI1IDAgMDEyLjUgMHpNMTYuMjUgMTJhMS4yNSAxLjI1IDAgMTAwLTIuNSAxLjI1IDEuMjUgMCAwMDAgMi41eiI+PC9wYXRoPjwvc3ZnPg==" alt=""></a>
        </div>
        <br>
        <div class="mui--text-headline">Furry Badges</div>
        <br>
        <div class="mui--text-center mui--align-middle">
            <button class="mui-btn"
                    id="userButton"
                    onclick="this.disabled = $('animalSelectContainer').hidden = $('animal').disabled = true; $('userSelectContainer').hidden = $('user').disabled = $('animalButton').disabled = false; updateBadge()"
                    disabled>
                User Badge
            </button>
            <button class="mui-btn"
                    id="animalButton"
                    onclick="this.disabled = $('userSelectContainer').hidden = $('user').disabled = true; $('animalSelectContainer').hidden = $('animal').disabled = $('userButton').disabled = false; updateBadge()">
                Animal Badge
            </button>
        </div>
        <div id="userBadge" class="mui-form">
            <div id="userAnimalSelect">
                <div id="userSelectContainer">
                    <div class="mui-select">
                        <select id="user" onchange="updateBadge()" required>
                            <option value="furry">furry</option>
                            {% for site in sites %}
                                {% if site != "furry" %}
                                    <option value="{{ site }}">{{ site }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        <label for="user">Site</label>
                    </div>
                </div>
                <div id="animalSelectContainer" hidden>
                    <div class="mui-select">
                        <select id="animal" onchange="updateBadge()" required disabled>
                            <option value="furry">furry</option>
                            {% for animal in animals %}
                                {% if animal != "furry" %}
                                    <option value="{{ animal }}">{{ animal }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        <label for="animal">Animal</label>
                    </div>
                </div>
            </div>
            <div class="mui-textfield mui-textfield--float-label">
                <input id="label" type="text" oninput="updateBadge()" value="">
                <label for="label">Label</label>
            </div>
            <div class="mui-checkbox">
                <label>
                    <input type="checkbox" id="noLabel" value=""
                           onclick="$('label').disabled = this.checked; updateBadge()">
                    No label
                </label>
            </div>
            <div class="mui-textfield mui-textfield--float-label">
                <input id="username" type="text" oninput="updateBadge()"
                       value="{{ placeholder_animal }}" required>
                <label for="username">Username</label>
            </div>
            <div id="colorPickers" class="mui--text-center mui--align-middle">
                <button id="labelColorButton" class="mui-btn" onclick="$('labelColor').click()">
                    <input type="color" id="labelColor"
                           style="opacity: 0; position: absolute; width: 100%; left: 0; margin: 0"
                           data-changed=""
                           onchange="this.dataset.changed = this.parentElement.style.backgroundColor = this.value + 'BB'; updateBadge()"
                           value="">
                    Label Color
                </button>
                <button id="messageColorButton" class="mui-btn" onclick="$('messageColor').click()">
                    <input type="color" id="messageColor"
                           style="opacity: 0; position: absolute; width: 100%; left: 0; margin: 0"
                           data-changed=""
                           onchange="this.dataset.changed = this.parentElement.style.backgroundColor = this.value + 'BB'; updateBadge()"
                           value="">
                    Message Color
                </button>
                <button class="mui-btn"
                        onclick="const l = $('labelColor'), m = $('messageColor'); l.parentElement.style.backgroundColor = m.parentElement.style.backgroundColor = l.value = m.value = l.dataset.changed = m.dataset.changed = ''; updateBadge()">
                    Reset Colors
                </button>
            </div>
        </div>
        <br><br>
        <div id="badgeContainer" class="mui--text-center mui--align-middle"
             style="cursor: pointer !important; min-height: 25px" hidden>
            <a id="badgeURL" href="#"><img id="badge" src="#" alt=""></a>
        </div>
        <br><br>
        <div id="copyMarkupContainer" hidden>
            <div class="mui-select" style="max-width: 300px; margin: auto">
                <select id="copyMarkup"
                        onchange="navigator.clipboard.writeText(this.selectedOptions[0].onselect(null)); this.selectedIndex = 0">
                    <option value="" disabled hidden selected>Copy URL & Markup</option>
                    <option value="url" onselect="return $('badge').src">Badge URL</option>
                    <option value="markdown" onselect="return `![](${$('badge').src})`">Markdown</option>
                    <option value="asciidoc" onselect="return `image::${$('badge').src}[]`">AsciiDoc</option>
                    <option value="restructuredtext" onselect="return `.. image:: ${$('badge').src}`">reStructuredText
                    </option>
                </select>
                <label for="copyMarkup"></label>
            </div>
        </div>
    </div>
    <div class="footer"><i>Style by <a href="https://www.muicss.com">Material Design CSS</a></i></div>
</div>
<script>
    const root = "https://furry-badges.herokuapp.com" //window.location.origin
    const $ = (id) => document.getElementById(id)
    const updateBadge = () => {
        const selector = document.querySelector("#userAnimalSelect div select:enabled")
        const badgeType = selector.id
        const badgeValue = selector.value
        const label = $("label").value.trim()
        const username = $("username").value.trim()
        const labelColor = $("labelColor")
        const color = $("messageColor")
        const noLabel = $("noLabel").checked
        let url
        if (!badgeValue || !username) url = null
        else {
            const url_ = new URL(root)
            url_.pathname = `/badge/${badgeType}/${badgeValue}/${encodeURIComponent(username)}/${encodeURIComponent(noLabel ? "" : label)}`
            if (noLabel) url_.searchParams.set("label", "")
            if (labelColor.dataset.changed !== '') url_.searchParams.set("labelColor", labelColor.value.replace(/^#/, ""))
            if (color.dataset.changed !== '') url_.searchParams.set("color", color.value.replace(/^#/, ""))
            url = url_.href
        }
        $("badge").src = $("badgeURL").href = !url ? "#" : url
        $("badgeContainer").hidden = $("copyMarkupContainer").hidden = url === null
    }
    window.onload = () => updateBadge()
</script>
</body>
</html>
